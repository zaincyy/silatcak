<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal Livescore Pencak Silat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            padding: 1.5rem;
            transition: all 0.3s ease;
        }
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .btn-primary {
            background-color: #1e40af;
            color: white;
        }
        .btn-primary:hover {
            background-color: #1d4ed8;
        }
        .btn-danger {
            background-color: #b91c1c;
            color: white;
        }
        .btn-danger:hover {
            background-color: #dc2626;
        }
        .btn-secondary {
            background-color: #4b5563;
            color: white;
        }
        .btn-secondary:hover {
            background-color: #6b7280;
        }
        .btn-warning {
            background-color: #f59e0b;
            color: white;
        }
        .btn-warning:hover {
            background-color: #fbbF04;
        }
        .hidden {
            display: none;
        }
        .pesilat-merah {
            background: linear-gradient(135deg, #ef4444, #b91c1c);
            color: white;
        }
        .pesilat-biru {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }
        .notification-banner {
            animation: fadeInOut 10s ease-in-out forwards;
        }
        @keyframes fadeInOut {
            0%, 100% { opacity: 0; transform: translateY(-20px); }
            10%, 90% { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div id="app">
        <!-- Semua halaman akan dirender di sini oleh JavaScript -->
    </div>

    <script>
        // SVG ICONS
        const PUKULAN_ICON = `data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0id2hpdGUiPjxwYXRoIGQ9Ik0xOC40IDguODZjLjgxIDAgMS41LS42MiAxLjYtMS40LjEzLTEuMDQtLjYyLTIuMS0xLjY2LTIuMS0uNzcgMC0xLjQzLjQ4LTEuNiAxLjItLjE0Ljc1LjM1IDEuNDQuOTYgMS43My4yMS4xLjQ0LjE0LjYyLjE0LjA4IDAgLjE3IDAgLjI1LS4wM00xMiA3LjVjLjgzIDAgMS41LS42NyAxLjUtMS41VjQuNWMwLS44My0uNjctMS41LTEuNS0xLjVTMTAuNSA1LjE3IDEwLjUgNnYxLjVjMCAuODMuNjcgMS41IDEuNSAxLjVtMy45IDEuMzZoMS43YzEuMDQgMCAxLjg4LS45OCAxLjY2LTIuMS0uMTYtLjg1LS44OS0xLjQtMS42Ni0xLjQtLjgyIDAtMS41LjYyLTEuNiAxLjQtLjEzIDEuMDQuNjIgMi4xIDEuNjYgMi4xTTguMSA4Ljg2Yy44MSAwIDEuNS0uNjIgMS42LTEuNC4xMy0xLjA0LS42Mi0yLjEtMS42Ni0yLjEtLjNzIDAgMS40My40OC0xLjYgMS4yLS4xNC43NS4zNSAxLjQ0Ljk2IDEuNzMuMjEuMS40NC4xNC42Mi4xNC4wOCAwIC4xNyAwIC4yNS0uMDNNMTkuMyAxMC42OGMtLjQ0LS4yNS0uOTgtLjItMS4zNi4xMmwtMS4zOCAxLjI1Yy0uMjguMjUtLjY1LjM5LTEuMDQuMzlIOS41Yy0uNTUgMC0xLS40NS0xLTFzLS40NS0xLTEtMUg1Yy0uNTUgMC0xIC40NS0xIDF2NWMwIC41NS40NSAxIDEgMWgyLjVjLjU1IDAgMS0uNDUgMS0xcy40NS0xIDEgMWgxLjVjLjM5IDAgLjc2LS4xNCAxLjA0LS4zOWwxLjM4LTEuMjVjLjM4LS4zMi40My0uODcuMTItMS4zNmwtLjAzLS4wNVoiLz48L3N2Zz4=`;
        const TENDANGAN_ICON = `data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0id2hpdGUiPjxwYXRoIGQ9Ik01LjUgOGMtMS4xIDAtMiAuOS0yIDJzLjkgMiAyIDIgMi0uOSAyLTItLjktMi0yLTJtMTEuNDIgMS4xOGwtMy41MyAzLjUzbC0xLjQyLTEuNDJsMS40Mi0xLjQyYy4zOS0uMzkgMS4wMi0uMzkgMS40MSAwbDEuNDEgMS40MWMuMzkuMzkgMS4wMi4zOSAxLjQxIDBsLjcxLS43MWMuMzktLjM5LjM5LTEuMDIgMC0xLjQxbC0xLjQyLTEuNDJjLS4zOS0uMzktMS4wMi0uMzktMS40MSAwbC0xLjQyIDEuNDJsLTEuMDYgMS4wNkwxMy41IDZsLTEuNDEtMS40MWMtLjM5LS4zOS0xLjAyLS4zOS0xLjQxIDBsLTEuNDIgMS40Mi0xLjQxIDEuNDFjLS4zOS4zOS0uMzkgMS4wMiAwIDEuNDFsLjcxLjcxYy4zOS4zOSAxLjAyLjM5IDEuNDEgMGwxLjQxLTEuNDFMMTMuNSA5LjVsMy41My0zLjUzbDEuNDIgMS40MWMuMzkuMzkgMS4wMi4zOSAxLjQxIDBsMS40MS0xLjQxYzEuMTctMS4xNy41NS0yLjgzLS45MS0yLjgzSDIwYy0xLjEgMC0yIC45LTIgMnYxLjA5Yy4wMS41My4yMSAxLjAzLjU4IDEuNDFabS02LjM2IDEyLjI2bC0uNzEtLjcxYy0uMzktLjM5LTEuMDItLjM5LTEuNDEgMGwtMS40MiAxLjQyYy0uMzkuMzktLjM5IDEuMDIgMCAxLjQxbDEuNDIgMS40MmMuMzkuMzkgMS4wMi4zOSAxLjQxIDBsMS40MS0xLjQxYy4zOS0uMzkuMzktMS4wMiAwLTEuNDFsLS43LS43MVoiLz48L3N2Zz4=`;
        const BINAAN_ICON = `data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iY3VycmVudENvbG9yIj48cGF0aCBkPSJNMTIgMi41YTEuNSAxLjUgMCAwIDAtMS41IDEuNVYxMmgzVjRjMC0uODMtLjY3LTEuNS0xLjUtMS41ek04LjUgMTRjMCAuODMuNjcgMS41IDEuNSAxLjVoNGMuODMgMCAxLjUtLjY3IDEuNS0xLjVWMTRoLTd2MHptNy41IDdoLTd2M2MwIDEuMS45IDIgMiAyaDNjMS4xIDAgMi0uOSAyLTJ2LTNoMHoiLz48L3N2Zz4=`;
        const TEGURAN_ICON = `data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iY3VycmVudENvbG9yIj48cGF0aCBkPSJNMi41IDEyaDEwLjI1bDItMnYtM2MwLS44My0uNjctMS41LTEuNS0xLjVIMTBDOS4xNyA1LjUgOC41IDYuMTcgOC41IDd2MS41SDQuNWMtLjg5IDAtMS42My42OC0xLjgzIDEuNTVMMS4xOSA3LjYyYy0uMzEtMS4zNi43My0yLjYyIDIuMDYtMi42MmgxLjI1VjRjMC0xLjEuOS0yIDItMmg0YzEuMSAwIDIgLjkgMiAydjFoLTQuNWMtLjg5IDAtMS42My42OC0xLjgzIDEuNTVMNi4xOSA3LjYyYy0uMzEtMS4zNi43My0yLjYyIDIuMDYtMi42MkgxNWMxLjEgMCAyIC45IDIgMnY0YzAgLjU5LS4yNyAxLjEtLjY4IDEuNDJsLTIgMnYtNWMwLS41NS0uNDUtMS0xLTFoLTJWN2MwLS41NS0uNDUtMS0xLTFoLTRjLS41NSAwLTEgLjQ1LTEgMXY0YzAgLjU1LjQ1IDEgMSAxaDYuNzVsMi4xMiAyLjEyYy41OC41OCAxLjM4Ljg4IDIuMjIuODhoLjQxYzEuMSAwIDItLjkgMi0ydi00YzAtMS4xLS45LTItMi0ySDE3di0xYzAtMS4xLS45LTItMi0yaC00Yy0xLjEgMC0yIC45LTIgMnYxSDdWN2MwLTEuMS0uOS0yLTItMkgzYy0xLjEgMC0yIC45LTIgMnY0YzAgMS4xLjkgMiAyIDJoMXoiLz48L3N2Zz4=`;
        const PELANGGARAN_ICON = `data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iY3VycmVudENvbG9yIj48cGF0aCBkPSJNNi41IDEwLjVjMC0uODMtLjY3LTEuNS0xLjUtMS41cy0xLjUuNjctMS41IDEuNXY0YzAgLjgzLjY3IDEuNSAxLjUgMS41czEuNS0uNjcgMS41LTEuNXYtNHptNS41IDBjMC0uODMtLjY3LTEuNS0xLjUtMS41cy0xLjUuNjctMS41IDEuNXY0YzAgLjgzLjY3IDEuNSAxLjUgMS41czEuNS0uNjcgMS41LTEuNXYtNHptNS41IDBjMC0uODMtLjY3LTEuNS0xLjUtMS41cy0xLjUuNjctMS41IDEuNXY0YzAgLjgzLjY3IDEuNSAxLjUgMS41czEuNS0uNjcgMS41LTEuNXYtNHptLTExIDguNWgxMHYtMmMwLTEuMS0uOS0yLTItMmgtOHYtMWMwLTEuMS0uOS0yLTItMkg0Yy0xLjEgMC0yIC45LTIgMnY0YzAgMS4xLjkgMiAyIDJoMS41di0xaDB6Ii8+PC9zdmc+`;
        const DISKUALIFIKASI_ICON = `data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iY3VycmVudENvbG9yIj48cGF0aCBkPSJNMTIgMi4yNWwtOC4yNSA4LjI1djguMjVIMTJ2LTQuNWg0LjV2LTQuNUwxMiAyLjI1ek01LjUgMTguNVYxMmwxLjUtMS41aDQuNXY0LjVoLTQuNVYxMi41SDUuNVYxMi41ek0xOC41IDE4LjVoLTQuNVYxMmwxLjUtMS41aDQuNXY0LjVoLTQuNVYxMi41SDE4LjV2NnoiLz48L3N2Zz4=`;

        const App = {
            data: {
                match: { name: 'PARTAI FINAL KELAS A PUTRA', pesilatMerah: { name: 'PESILAT SUDUT MERAH', perguruan: 'PERGURUAN A' }, pesilatBiru: { name: 'PESILAT SUDUT BIRU', perguruan: 'PERGURUAN B' } },
                timer: { initialTime: 180, time: 180, isRunning: false, intervalId: null },
                scores: { juri1: { merah: 0, biru: 0 }, juri2: { merah: 0, biru: 0 }, juri3: { merah: 0, biru: 0 } },
                dewan: { lastAction: null, history: [] },
                ketua: { winner: null },
                operator: { runningText: 'SELAMAT DATANG DI ARENA PERTANDINGAN PENCAK SILAT' },
                users: { operators: [{ username: 'operator01', pass: '123' }] },
                pesertaList: [{ name: 'Iko Uwais', perguruan: 'Tiga Berantai' }, { name: 'Yayan Ruhian', perguruan: 'Pencak Silat Tenaga Dasar' }, { name: 'Cecep Arif Rahman', perguruan: 'Panglipur' }]
            },
            init() { this.loadData(); this.router(); window.addEventListener('hashchange', () => this.router()); window.addEventListener('storage', (e) => { if (e.key === 'silat_livescore') { this.loadData(); this.render(); } }); },
            router() { const path = window.location.hash || '#dashboard'; const page = path.split('/')[0]; const param = path.split('/')[1]; this.currentPage = page; this.param = param; this.render(); },
            render() {
                const appContainer = document.getElementById('app');
                appContainer.innerHTML = '';
                let pageContent = '';
                switch (this.currentPage) {
                    case '#operator': pageContent = this.renderOperatorPage(); break;
                    case '#juri': pageContent = this.renderJuriPage(this.param); break;
                    case '#dewan': pageContent = this.renderDewanPage(); break;
                    case '#ketua': pageContent = this.renderKetuaPage(); break;
                    case '#papan-skor': pageContent = this.renderPapanSkorPage(); break;
                    case '#admin': pageContent = this.renderAdminPage(); break;
                    default: pageContent = this.renderDashboard();
                }
                appContainer.innerHTML = pageContent;
                this.attachEventListeners();
            },
            renderDashboard() { 
                return `
                    <div class="text-center mb-8">
                        <h1 class="text-4xl font-bold text-gray-800">Portal Livescore</h1>
                        <p class="text-gray-600">Pilih peran Anda untuk melanjutkan</p>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 max-w-6xl mx-auto">
                        <a href="#operator" class="card text-center hover:shadow-xl hover:-translate-y-1"><i class="fa-solid fa-sliders text-5xl text-green-600 mb-4"></i><h2 class="text-xl font-bold">Operator</h2></a>
                        <a href="#ketua" class="card text-center hover:shadow-xl hover:-translate-y-1"><i class="fa-solid fa-gavel text-5xl text-purple-600 mb-4"></i><h2 class="text-xl font-bold">Ketua Pertandingan</h2></a>
                        <a href="#dewan" class="card text-center hover:shadow-xl hover:-translate-y-1"><i class="fa-solid fa-book-open text-5xl text-yellow-600 mb-4"></i><h2 class="text-xl font-bold">Dewan</h2></a>
                        <a href="#juri/1" class="card text-center hover:shadow-xl hover:-translate-y-1"><i class="fa-solid fa-user-tie text-5xl text-red-600 mb-4"></i><h2 class="text-xl font-bold">Juri 1</h2></a>
                        <a href="#juri/2" class="card text-center hover:shadow-xl hover:-translate-y-1"><i class="fa-solid fa-user-tie text-5xl text-red-600 mb-4"></i><h2 class="text-xl font-bold">Juri 2</h2></a>
                        <a href="#juri/3" class="card text-center hover:shadow-xl hover:-translate-y-1"><i class="fa-solid fa-user-tie text-5xl text-red-600 mb-4"></i><h2 class="text-xl font-bold">Juri 3</h2></a>
                        <a href="#papan-skor" target="_blank" class="card text-center hover:shadow-xl hover:-translate-y-1 col-span-2 md:col-span-1 lg:col-span-1"><i class="fa-solid fa-tv text-5xl text-gray-700 mb-4"></i><h2 class="text-xl font-bold">Papan Skor Publik</h2></a>
                    </div>
                `; 
            },
            renderAdminPage() { let operatorList = this.data.users.operators.map((op, index) => `<tr class="border-b"><td class="p-2">${op.username}</td><td class="p-2">******</td><td class="p-2"><button class="btn btn-danger text-sm" data-action="deleteOperator" data-index="${index}">Hapus</button></td></tr>`).join(''); return `<a href="#dashboard" class="text-blue-600 mb-4 inline-block"><i class="fas fa-arrow-left"></i> Kembali ke Dashboard</a><h1 class="text-3xl font-bold mb-4">Admin: Manajemen Operator</h1><div class="grid md:grid-cols-2 gap-8"><div class="card"><h2 class="text-2xl font-semibold mb-4">Tambah Operator Baru</h2><div class="space-y-4"><div><label class="block text-sm font-medium text-gray-700">Username</label><input id="newOpUsername" type="text" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2"></div><div><label class="block text-sm font-medium text-gray-700">Password</label><input id="newOpPass" type="password" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2"></div><button class="btn btn-primary w-full" data-action="addOperator">Tambah</button></div></div><div class="card"><h2 class="text-2xl font-semibold mb-4">Daftar Operator</h2><table class="w-full text-left"><thead><tr class="border-b"><th class="p-2">Username</th><th class="p-2">Password</th><th class="p-2">Aksi</th></tr></thead><tbody>${operatorList}</tbody></table></div></div>`; },
            renderOperatorPage() {
                const { name, pesilatMerah, pesilatBiru } = this.data.match;
                const { time, isRunning, initialTime } = this.data.timer;
                const { runningText } = this.data.operator;
                const minutes = Math.floor(time / 60).toString().padStart(2, '0');
                const seconds = (time % 60).toString().padStart(2, '0');
                const initialMinutes = Math.floor(initialTime / 60);
                const initialSeconds = initialTime % 60;

                return `<a href="#dashboard" class="text-blue-600 mb-4 inline-block"><i class="fas fa-arrow-left"></i> Kembali ke Dashboard</a><h1 class="text-3xl font-bold mb-6">Panel Operator</h1><div class="grid grid-cols-1 lg:grid-cols-3 gap-6"><div class="card lg:col-span-1"><h2 class="text-xl font-semibold mb-4">Pengaturan Pertandingan</h2><div class="space-y-4"><div><label class="block text-sm font-medium text-gray-700">Nama Pertandingan</label><input type="text" id="matchName" value="${name}" data-key="match.name" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2"></div><div><label class="block text-sm font-medium text-gray-700">Nama Pesilat Merah</label><input type="text" id="pesilatMerahName" value="${pesilatMerah.name}" data-key="match.pesilatMerah.name" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2"></div><div><label class="block text-sm font-medium text-gray-700">Perguruan Merah</label><input type="text" id="pesilatMerahPerguruan" value="${pesilatMerah.perguruan}" data-key="match.pesilatMerah.perguruan" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2"></div><div><label class="block text-sm font-medium text-gray-700">Nama Pesilat Biru</label><input type="text" id="pesilatBiruName" value="${pesilatBiru.name}" data-key="match.pesilatBiru.name" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2"></div><div><label class="block text-sm font-medium text-gray-700">Perguruan Biru</label><input type="text" id="pesilatBiruPerguruan" value="${pesilatBiru.perguruan}" data-key="match.pesilatBiru.perguruan" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2"></div></div></div><div class="card lg:col-span-1 text-center"><h2 class="text-xl font-semibold mb-4">Kontrol Waktu</h2><div class="text-7xl font-bold my-6">${minutes}:${seconds}</div><div class="flex justify-center space-x-4"><button data-action="timerPlay" class="btn btn-primary ${isRunning ? 'hidden' : ''}"><i class="fas fa-play"></i> Play</button><button data-action="timerPause" class="btn btn-secondary ${!isRunning ? 'hidden' : ''}"><i class="fas fa-pause"></i> Pause</button><button data-action="timerReset" class="btn btn-danger"><i class="fas fa-sync"></i> Reset</button></div><div class="mt-6 border-t pt-4"><h3 class="text-lg font-semibold mb-2">Atur Waktu Pertandingan</h3><div class="flex items-center justify-center space-x-2 text-black"><input type="number" id="customMinutes" class="w-20 p-2 text-center border rounded" value="${initialMinutes}"><span class="font-bold text-gray-700">:</span><input type="number" id="customSeconds" class="w-20 p-2 text-center border rounded" value="${initialSeconds}"></div><button data-action="setCustomTime" class="btn btn-primary w-full mt-3">Set Waktu</button></div></div><div class="card lg:col-span-1"><h2 class="text-xl font-semibold mb-4">Pengaturan Lain</h2><div><label class="block text-sm font-medium text-gray-700">Running Text</label><textarea id="runningText" data-key="operator.runningText" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2">${runningText}</textarea></div><div class="mt-6"><h3 class="text-lg font-semibold">Reset Data</h3><p class="text-sm text-gray-500 mb-2">Mengatur ulang semua skor dan status pertandingan.</p><button data-action="resetAll" class="btn btn-warning w-full">Reset Pertandingan</button></div></div></div>`;
            },
            renderJuriPage(juriId) {
                if (!['1', '2', '3'].includes(juriId)) { return `<div class="card text-center"><h1 class="text-2xl text-red-600">Juri tidak valid.</h1><a href="#dashboard" class="text-blue-600 mt-4 inline-block">Kembali</a></div>`; }
                const juriKey = `juri${juriId}`; const { pesilatMerah, pesilatBiru } = this.data.match; const skor = this.data.scores[juriKey];
                return `<a href="#dashboard" class="text-blue-600 mb-4 inline-block"><i class="fas fa-arrow-left"></i> Kembali ke Dashboard</a><h1 class="text-3xl font-bold mb-2 text-center">Panel Juri ${juriId}</h1><p class="text-center text-gray-600 mb-6">Klik tombol untuk memberikan nilai.</p><div class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-5xl mx-auto"><div class="card pesilat-merah text-white p-6 text-center"><h2 class="text-2xl font-bold">${pesilatMerah.name}</h2><p class="opacity-80 mb-4">${pesilatMerah.perguruan}</p><div class="text-7xl font-black my-4">${skor.merah}</div><div class="space-y-4"><button data-action="addScore" data-juri="${juriKey}" data-pesilat="merah" data-value="1" class="w-full bg-white/20 hover:bg-white/30 rounded-lg p-4 flex flex-col items-center justify-center transition-transform transform hover:scale-105"><img src="${PUKULAN_ICON}" alt="Pukulan" class="h-16 w-16 mb-2"><span class="text-xl font-bold">PUKULAN (+1)</span></button><button data-action="addScore" data-juri="${juriKey}" data-pesilat="merah" data-value="2" class="w-full bg-white/20 hover:bg-white/30 rounded-lg p-4 flex flex-col items-center justify-center transition-transform transform hover:scale-105"><img src="${TENDANGAN_ICON}" alt="Tendangan" class="h-16 w-16 mb-2"><span class="text-xl font-bold">TENDANGAN (+2)</span></button><button data-action="addScore" data-juri="${juriKey}" data-pesilat="merah" data-value="3" class="w-full bg-white/20 hover:bg-white/30 rounded-lg p-4 text-xl font-bold transition-transform transform hover:scale-105">JATUHAN (+3)</button></div></div><div class="card pesilat-biru text-white p-6 text-center"><h2 class="text-2xl font-bold">${pesilatBiru.name}</h2><p class="opacity-80 mb-4">${pesilatBiru.perguruan}</p><div class="text-7xl font-black my-4">${skor.biru}</div><div class="space-y-4"><button data-action="addScore" data-juri="${juriKey}" data-pesilat="biru" data-value="1" class="w-full bg-white/20 hover:bg-white/30 rounded-lg p-4 flex flex-col items-center justify-center transition-transform transform hover:scale-105"><img src="${PUKULAN_ICON}" alt="Pukulan" class="h-16 w-16 mb-2"><span class="text-xl font-bold">PUKULAN (+1)</span></button><button data-action="addScore" data-juri="${juriKey}" data-pesilat="biru" data-value="2" class="w-full bg-white/20 hover:bg-white/30 rounded-lg p-4 flex flex-col items-center justify-center transition-transform transform hover:scale-105"><img src="${TENDANGAN_ICON}" alt="Tendangan" class="h-16 w-16 mb-2"><span class="text-xl font-bold">TENDANGAN (+2)</span></button><button data-action="addScore" data-juri="${juriKey}" data-pesilat="biru" data-value="3" class="w-full bg-white/20 hover:bg-white/30 rounded-lg p-4 text-xl font-bold transition-transform transform hover:scale-105">JATUHAN (+3)</button></div></div></div>`;
            },
            renderDewanPage() {
                let historyItems = this.data.dewan.history.map(item => `<li class="border-b py-2 flex justify-between items-center"><span>${item.pesilat === 'merah' ? 'MERAH' : 'BIRU'}: ${item.type}</span> <span class="text-xs text-gray-500">${new Date(item.timestamp).toLocaleTimeString()}</span></li>`).join('');
                return `<a href="#dashboard" class="text-blue-600 mb-4 inline-block"><i class="fas fa-arrow-left"></i> Kembali ke Dashboard</a><h1 class="text-3xl font-bold mb-6">Panel Dewan</h1><div class="grid md:grid-cols-2 gap-8"><div class="card"><h2 class="text-2xl font-semibold mb-4">Input Aksi</h2><div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-1">Pilih Pesilat</label><select id="dewanPesilat" class="w-full rounded-md border-gray-300 shadow-sm p-2"><option value="merah">Pesilat Merah</option><option value="biru">Pesilat Biru</option></select></div><div class="grid grid-cols-2 gap-4">${this.renderDewanButton('Binaan', BINAAN_ICON, 'bg-green-500')}${this.renderDewanButton('Teguran', TEGURAN_ICON, 'bg-yellow-500')}${this.renderDewanButton('Pelanggaran', PELANGGARAN_ICON, 'bg-orange-500')}${this.renderDewanButton('Diskualifikasi', DISKUALIFIKASI_ICON, 'bg-red-600')}</div></div><div class="card"><h2 class="text-2xl font-semibold mb-4">Riwayat Aksi</h2><ul class="space-y-2">${historyItems || '<li>Belum ada aksi.</li>'}</ul></div></div>`;
            },
            renderDewanButton(type, icon, bgColor) {
                return `<button data-action="dewanAction" data-type="${type}" class="w-full ${bgColor} text-white rounded-lg p-4 flex flex-col items-center justify-center transition-transform transform hover:scale-105 shadow-lg"><img src="${icon}" alt="${type}" class="h-16 w-16 mb-2 filter invert"><span class="text-xl font-bold">${type}</span></button>`;
            },
            renderKetuaPage() { const { dewan, ketua } = this.data; const lastAction = dewan.lastAction; let dewanInfo = '<p class="text-gray-500">Tidak ada aksi terbaru dari Dewan.</p>'; if (lastAction && !lastAction.verified) { dewanInfo = `<div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4"><p class="font-bold">Aksi Baru dari Dewan</p><p>Pesilat ${lastAction.pesilat.toUpperCase()} mendapat ${lastAction.type}.</p><button data-action="verifyDewanAction" class="btn btn-primary text-sm mt-2">Verifikasi</button></div>`; } else if (lastAction && lastAction.verified) { dewanInfo = '<p class="text-green-600">Aksi terakhir sudah diverifikasi.</p>'; } let pesertaRows = this.data.pesertaList.map((p, index) => `<tr class="border-b"><td class="p-2">${p.name}</td><td class="p-2">${p.perguruan}</td><td class="p-2"><button data-action="deletePeserta" data-index="${index}" class="text-red-500 hover:text-red-700"><i class="fas fa-trash"></i></button></td></tr>`).join(''); return `<a href="#dashboard" class="text-blue-600 mb-4 inline-block"><i class="fas fa-arrow-left"></i> Kembali ke Dashboard</a><h1 class="text-3xl font-bold mb-6">Panel Ketua Pertandingan</h1><div class="grid lg:grid-cols-3 gap-6"><div class="lg:col-span-2 space-y-6"><div class="card"><h2 class="text-xl font-semibold mb-4">Status Pertandingan</h2>${dewanInfo}<div class="mt-6"><h3 class="text-lg font-semibold">Tentukan Pemenang</h3>${ketua.winner ? `<p class="text-xl font-bold text-green-600">Pemenang telah ditentukan: ${ketua.winner.toUpperCase()}</p>` : ''}<div class="flex space-x-4 mt-2 ${ketua.winner ? 'hidden' : ''}"><button data-action="setWinner" data-winner="merah" class="btn btn-danger w-full">Menangkan MERAH</button><button data-action="setWinner" data-winner="biru" class="btn btn-primary w-full">Menangkan BIRU</button></div></div></div><div class="card"><h2 class="text-xl font-semibold mb-4">Acak Pertandingan</h2><p class="text-sm text-gray-500 mb-2">Pilih 2 peserta secara acak dari daftar dan atur sebagai pertandingan saat ini.</p><button data-action="acakPertandingan" class="btn btn-secondary w-full">Acak Sekarang!</button></div></div><div class="lg:col-span-1 card"><h2 class="text-xl font-semibold mb-4">Manajemen Peserta</h2><div class="space-y-2 mb-4"><input id="pesertaName" type="text" placeholder="Nama Pesilat" class="w-full rounded-md border-gray-300 p-2"><input id="pesertaPerguruan" type="text" placeholder="Nama Perguruan" class="w-full rounded-md border-gray-300 p-2"><button data-action="addPeserta" class="btn btn-primary w-full">Tambah Peserta</button></div><h3 class="font-semibold mt-4">Daftar Peserta</h3><div class="h-64 overflow-y-auto"><table class="w-full text-left text-sm"><thead><tr class="border-b"><th class="p-2">Nama</th><th class="p-2">Perguruan</th><th class="p-2">Aksi</th></tr></thead><tbody>${pesertaRows}</tbody></table></div></div></div>`; },
            renderPapanSkorPage() { const { match, scores, timer, operator, dewan, ketua } = this.data; const totalMerah = scores.juri1.merah + scores.juri2.merah + scores.juri3.merah; const totalBiru = scores.juri1.biru + scores.juri2.biru + scores.juri3.biru; const minutes = Math.floor(timer.time / 60).toString().padStart(2, '0'); const seconds = (timer.time % 60).toString().padStart(2, '0'); const penalties = { merah: { Binaan: 0, Teguran: 0, Pelanggaran: 0 }, biru: { Binaan: 0, Teguran: 0, Pelanggaran: 0 } }; dewan.history.forEach(action => { if (action.verified && penalties[action.pesilat] && penalties[action.pesilat][action.type] !== undefined) { penalties[action.pesilat][action.type]++; } }); let dewanNotification = ''; if (dewan.lastAction && dewan.lastAction.verified) { dewanNotification = `<div class="notification-banner absolute top-4 left-1/2 -translate-x-1/2 bg-yellow-400 text-black font-bold p-4 rounded-lg shadow-lg z-50 text-2xl">DEWAN: PESILAT ${dewan.lastAction.pesilat.toUpperCase()} - ${dewan.lastAction.type}</div>`; } let winnerOverlay = ''; if (ketua.winner) { const winnerData = ketua.winner === 'merah' ? match.pesilatMerah : match.pesilatBiru; const winnerColor = ketua.winner === 'merah' ? 'bg-red-600' : 'bg-blue-600'; winnerOverlay = `<div class="absolute inset-0 bg-black/80 flex flex-col justify-center items-center z-40 text-white"><h2 class="text-5xl font-bold mb-8">Pertandingan Selesai</h2><div class="text-center p-8 rounded-lg ${winnerColor} w-3/4 md:w-1/2"><p class="text-3xl">Pemenang</p><h1 class="text-7xl font-black my-4">${winnerData.name}</h1><p class="text-3xl">${winnerData.perguruan}</p></div><button data-action="closeWinner" class="btn btn-secondary mt-8 text-2xl">Tutup</button></div>`; } return `<div class="min-h-screen bg-black text-white flex flex-col p-2 md:p-4 font-sans">${dewanNotification}${winnerOverlay}<div class="w-full text-center py-2 text-2xl font-bold border-b-2 border-white overflow-hidden"><p class="whitespace-nowrap animate-marquee">${operator.runningText}</p></div><div class="grid grid-cols-11 items-center text-center my-4 gap-2"><div class="col-span-5 bg-red-600 p-4 rounded-lg"><h2 class="text-2xl md:text-4xl font-bold">${match.pesilatMerah.perguruan}</h2><p class="text-xl md:text-3xl">${match.pesilatMerah.name}</p></div><div class="col-span-1 text-6xl md:text-8xl font-black">VS</div><div class="col-span-5 bg-blue-600 p-4 rounded-lg"><h2 class="text-2xl md:text-4xl font-bold">${match.pesilatBiru.perguruan}</h2><p class="text-xl md:text-3xl">${match.pesilatBiru.name}</p></div></div><div class="flex-grow grid grid-cols-11 gap-2 md:gap-4 items-center"><div class="col-span-3 flex flex-col space-y-2 h-full"><div class="flex-1 bg-black border-2 border-white p-2 text-center text-lg md:text-2xl rounded-lg flex justify-center items-center">Binaan ${penalties.merah.Binaan}</div><div class="flex-1 bg-black border-2 border-white p-2 text-center text-lg md:text-2xl rounded-lg flex justify-center items-center">Teguran ${penalties.merah.Teguran}</div><div class="flex-1 bg-black border-2 border-white p-2 text-center text-lg md:text-2xl rounded-lg flex justify-center items-center">Pelanggaran ${penalties.merah.Pelanggaran}</div></div><div class="col-span-2 bg-red-600 h-full flex justify-center items-center rounded-lg"><span class="text-8xl md:text-9xl font-black">${totalMerah}</span></div><div class="col-span-1 h-full flex justify-center items-center"><div class="bg-white text-black w-full h-1/3 flex justify-center items-center text-xl md:text-4xl font-bold rounded-lg">RONDE 1</div></div><div class="col-span-2 bg-blue-600 h-full flex justify-center items-center rounded-lg"><span class="text-8xl md:text-9xl font-black">${totalBiru}</span></div><div class="col-span-3 flex flex-col space-y-2 h-full"><div class="flex-1 bg-black border-2 border-white p-2 text-center text-lg md:text-2xl rounded-lg flex justify-center items-center">Binaan ${penalties.biru.Binaan}</div><div class="flex-1 bg-black border-2 border-white p-2 text-center text-lg md:text-2xl rounded-lg flex justify-center items-center">Teguran ${penalties.biru.Teguran}</div><div class="flex-1 bg-black border-2 border-white p-2 text-center text-lg md:text-2xl rounded-lg flex justify-center items-center">Pelanggaran ${penalties.biru.Pelanggaran}</div></div></div><div class="grid grid-cols-11 text-center my-4 gap-2"><div class="col-span-5 bg-black border-2 border-white p-2 rounded-lg"><span class="text-lg md:text-2xl">Juri Yang Memberi Nilai : <strong>J1 J2 J3</strong></span></div><div class="col-span-1"></div><div class="col-span-5 bg-black border-2 border-white p-2 rounded-lg"><span class="text-lg md:text-2xl">Juri Yang Memberi Nilai : <strong>J1 J2 J3</strong></span></div></div><div class="w-full text-center py-2 text-7xl md:text-8xl font-black border-t-2 border-white mt-2">${minutes}:${seconds}</div></div><style>@keyframes marquee {0% { transform: translateX(100%); } 100% { transform: translateX(-150%); } } .animate-marquee { display: inline-block; padding-left: 100%; animation: marquee 15s linear infinite; }</style>`; },
            attachEventListeners() { const appContainer = document.getElementById('app'); appContainer.querySelectorAll('input, textarea').forEach(input => { input.addEventListener('input', (e) => { const keyPath = e.target.dataset.key; if (keyPath) this.updateData(keyPath, e.target.value); }); }); appContainer.addEventListener('click', (e) => { const button = e.target.closest('button'); if (!button) return; const action = button.dataset.action; if (action) this.handleAction(action, button.dataset); }); },
            handleAction(action, dataset) {
                switch (action) {
                    case 'addOperator': const username = document.getElementById('newOpUsername').value; const pass = document.getElementById('newOpPass').value; if (username && pass) { this.data.users.operators.push({ username, pass }); this.saveAndRender(); } else { alert('Username dan password tidak boleh kosong.'); } break;
                    case 'deleteOperator': if (confirm('Anda yakin ingin menghapus operator ini?')) { this.data.users.operators.splice(dataset.index, 1); this.saveAndRender(); } break;
                    case 'timerPlay': this.timerPlay(); break;
                    case 'timerPause': this.timerPause(); break;
                    case 'timerReset': this.timerReset(); break;
                    case 'setCustomTime':
                        const customMinutes = parseInt(document.getElementById('customMinutes').value) || 0;
                        const customSeconds = parseInt(document.getElementById('customSeconds').value) || 0;
                        const newTotalSeconds = (customMinutes * 60) + customSeconds;
                        if (newTotalSeconds >= 0) {
                            this.data.timer.initialTime = newTotalSeconds;
                            this.timerReset();
                        } else {
                            alert('Waktu tidak valid.');
                        }
                        break;
                    case 'resetAll': if (confirm('Anda yakin ingin mereset seluruh pertandingan? Skor dan status akan kembali ke awal.')) { this.resetMatch(); this.saveAndRender(); } break;
                    case 'addScore': this.data.scores[dataset.juri][dataset.pesilat] += parseInt(dataset.value); this.saveAndRender(); break;
                    case 'dewanAction': const pesilat = document.getElementById('dewanPesilat').value; const actionData = { type: dataset.type, pesilat: pesilat, timestamp: new Date().toISOString(), verified: false }; this.data.dewan.lastAction = actionData; this.data.dewan.history.unshift(actionData); this.saveAndRender(); break;
                    case 'verifyDewanAction': if (this.data.dewan.lastAction) { this.data.dewan.lastAction.verified = true; setTimeout(() => { this.data.dewan.lastAction = null; this.saveAndRender(); }, 10000); this.saveAndRender(); } break;
                    case 'setWinner': if (confirm(`Anda yakin ingin menetapkan ${dataset.winner.toUpperCase()} sebagai pemenang?`)) { this.data.ketua.winner = dataset.winner; this.timerPause(); this.saveAndRender(); } break;
                    case 'addPeserta': const name = document.getElementById('pesertaName').value; const perguruan = document.getElementById('pesertaPerguruan').value; if (name && perguruan) { this.data.pesertaList.push({ name, perguruan }); this.saveAndRender(); } break;
                    case 'deletePeserta': this.data.pesertaList.splice(dataset.index, 1); this.saveAndRender(); break;
                    case 'acakPertandingan': this.acakPertandingan(); break;
                    case 'closeWinner': this.resetMatch(); this.saveAndRender(); break;
                }
            },
            saveData() { localStorage.setItem('silat_livescore', JSON.stringify(this.data)); },
            loadData() { const savedData = localStorage.getItem('silat_livescore'); if (savedData) { const parsedData = JSON.parse(savedData); this.data = { ...this.data, ...parsedData }; } },
            saveAndRender() { this.saveData(); this.render(); },
            updateData(keyPath, value) { let current = this.data; const keys = keyPath.split('.'); keys.forEach((key, index) => { if (index === keys.length - 1) current[key] = value; else current = current[key]; }); this.saveData(); },
            timerPlay() { if (this.data.timer.isRunning) return; this.data.timer.isRunning = true; this.data.timer.intervalId = setInterval(() => { if (this.data.timer.time > 0) { this.data.timer.time--; this.saveAndRender(); } else { this.timerPause(); } }, 1000); this.saveAndRender(); },
            timerPause() { clearInterval(this.data.timer.intervalId); this.data.timer.isRunning = false; this.saveAndRender(); },
            timerReset() { this.timerPause(); this.data.timer.time = this.data.timer.initialTime; this.saveAndRender(); },
            resetMatch() { this.timerPause(); this.data.timer.time = this.data.timer.initialTime; this.data.scores = { juri1: { merah: 0, biru: 0 }, juri2: { merah: 0, biru: 0 }, juri3: { merah: 0, biru: 0 } }; this.data.dewan = { lastAction: null, history: [] }; this.data.ketua.winner = null; this.saveAndRender(); },
            acakPertandingan() { if (this.data.pesertaList.length < 2) { alert('Tidak cukup peserta untuk diacak. Tambahkan minimal 2 peserta.'); return; } if (!confirm('Ini akan mengganti pesilat saat ini. Lanjutkan?')) return; let shuffled = [...this.data.pesertaList].sort(() => 0.5 - Math.random()); const pesilat1 = shuffled[0]; const pesilat2 = shuffled[1]; this.resetMatch(); this.data.match.pesilatMerah = pesilat1; this.data.match.pesilatBiru = pesilat2; this.data.match.name = `Pertandingan antara ${pesilat1.name} vs ${pesilat2.name}`; this.saveAndRender(); alert(`Pertandingan baru telah diatur:\nMERAH: ${pesilat1.name}\nBIRU: ${pesilat2.name}`); }
        };
        App.init();
    </script>

</body>
</html>

